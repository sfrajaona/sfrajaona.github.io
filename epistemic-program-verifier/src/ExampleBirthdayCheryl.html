<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : ExampleBirthdayCheryl
Description : Implementation  of the Cheryl's Birthday Puzzle 
Copyright   :
License     : 
Maintainer  : Anonymous
Portability : 
Stability   : 

Cheryl's birthday is one of 10 possible dates: 

 @
 May           15  16          19
 June                  17  18  
 July      14      16      
 August    14  15      17    
 @

 Cheryl tells Albert the month and tells Bernard the day. Then proceeds the following announcement.

* 'annAlbert1': Albert does not know the day and Albert knows that Bernard does not know the month 
* 'annBernard': Bernard annouces he knows the month now 
* 'annAlbert2': Albert annouces he knows the day now 

 The couples (@day@,@month@) that satisfy the puzzle is computed with the functions 'cherylsBirthday'.  Simplified version of the puzzle are given in 'cherylsBirthday2' and 'cherylsBirthday3'.

 In the original version of the puzzle, in the second announcement 'annBernard', Bernard announces that Bernard it didn't know the month before Albert's announcement.  This cannot be captured by the logic.  The original version and our version yields the same unique solution.
-}</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">ExampleBirthdayCheryl</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ExampleBirthdayCheryl.html#cherylsBirthday"><span class="hs-identifier">cherylsBirthday</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ExampleBirthdayCheryl.html#cherylsBirthday2"><span class="hs-identifier">cherylsBirthday2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ExampleBirthdayCheryl.html#cherylsBirthday3"><span class="hs-identifier">cherylsBirthday3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ExampleBirthdayCheryl.html#cherylsBirthdayOriginal"><span class="hs-identifier">cherylsBirthdayOriginal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ExampleBirthdayCheryl.html#annAlbert1"><span class="hs-identifier">annAlbert1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ExampleBirthdayCheryl.html#annBernard"><span class="hs-identifier">annBernard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ExampleBirthdayCheryl.html#annAlbert2"><span class="hs-identifier">annAlbert2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.SBV</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Logics.html"><span class="hs-identifier">Logics</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Translation.html"><span class="hs-identifier">Translation</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ToSBV.html"><span class="hs-identifier">ToSBV</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ToString.html"><span class="hs-identifier">ToString</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="StateInitialisation.html"><span class="hs-identifier">StateInitialisation</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- * AGENTS and VARIABLES --</span><span>
</span><span id="line-42"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-43"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#albert"><span class="hs-identifier hs-type">albert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span> </span><span>
</span><span id="line-44"></span><span id="albert"><span class="annot"><span class="annottext">albert :: Agent
</span><a href="ExampleBirthdayCheryl.html#albert"><span class="hs-identifier hs-var hs-var">albert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Agent :: Int -&gt; [Var] -&gt; Agent
</span><a href="Logics.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">identity :: Int
</span><a href="Logics.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nonobs :: [Var]
</span><a href="Logics.html#nonobs"><span class="hs-identifier hs-var">nonobs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-special">}</span><span> </span><span>
</span><span id="line-45"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#bernard"><span class="hs-identifier hs-type">bernard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span> </span><span>
</span><span id="line-46"></span><span id="bernard"><span class="annot"><span class="annottext">bernard :: Agent
</span><a href="ExampleBirthdayCheryl.html#bernard"><span class="hs-identifier hs-var hs-var">bernard</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Agent :: Int -&gt; [Var] -&gt; Agent
</span><a href="Logics.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">identity :: Int
</span><a href="Logics.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nonobs :: [Var]
</span><a href="Logics.html#nonobs"><span class="hs-identifier hs-var">nonobs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span> </span><span>
</span><span id="line-47"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-type">month</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-48"></span><span id="month"><span class="annot"><span class="annottext">month :: Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var hs-var">month</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Logics.html#NVar"><span class="hs-identifier hs-var">NVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;month&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-type">day</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-50"></span><span id="day"><span class="annot"><span class="annottext">day :: Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var hs-var">day</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Logics.html#NVar"><span class="hs-identifier hs-var">NVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;day&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">-----------------------------------</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- * Initial states  --</span><span>
</span><span id="line-54"></span><span class="hs-comment">-----------------------------------</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | each state S(i)  given as a mapping/couple of (variable, value)</span><span>
</span><span id="line-56"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#initS"><span class="hs-identifier hs-type">initS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-57"></span><span id="initS"><span class="annot"><span class="annottext">initS :: Integer -&gt; [(Var, Integer)]
</span><a href="ExampleBirthdayCheryl.html#initS"><span class="hs-identifier hs-var hs-var">initS</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">15</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-58"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#initS"><span class="hs-identifier hs-var">initS</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-59"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#initS"><span class="hs-identifier hs-var">initS</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">19</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-60"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#initS"><span class="hs-identifier hs-var">initS</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">6</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">17</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#initS"><span class="hs-identifier hs-var">initS</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">6</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">18</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#initS"><span class="hs-identifier hs-var">initS</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">14</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#initS"><span class="hs-identifier hs-var">initS</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">6</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-64"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#initS"><span class="hs-identifier hs-var">initS</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">14</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#initS"><span class="hs-identifier hs-var">initS</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">15</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#initS"><span class="hs-identifier hs-var">initS</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">9</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">17</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | initial states converted into a Map</span><span>
</span><span id="line-69"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#initialStates"><span class="hs-identifier hs-type">initialStates</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="StateInitialisation.html#State"><span class="hs-identifier hs-type">State</span></a></span><span class="hs-special">]</span><span>  </span><span>
</span><span id="line-70"></span><span id="initialStates"><span class="annot"><span class="annottext">initialStates :: [State]
</span><a href="ExampleBirthdayCheryl.html#initialStates"><span class="hs-identifier hs-var hs-var">initialStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Bool)] -&gt; Map Var Bool
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Var, Integer)] -&gt; Map Var Integer
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; [(Var, Integer)]
</span><a href="ExampleBirthdayCheryl.html#initS"><span class="hs-identifier hs-var">initS</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065329"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679065329"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065329"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">9</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | initial states converted into a Formula</span><span>
</span><span id="line-73"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#phis"><span class="hs-identifier hs-type">phis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logics.html#FOLFormula"><span class="hs-identifier hs-type">FOLFormula</span></a></span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-74"></span><span id="phis"><span class="annot"><span class="annottext">phis :: [FOLFormula]
</span><a href="ExampleBirthdayCheryl.html#phis"><span class="hs-identifier hs-var hs-var">phis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Var] -&gt; State -&gt; FOLFormula
</span><a href="StateInitialisation.html#toFormula"><span class="hs-identifier hs-var">toFormula</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679065326"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679065326"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679065326"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="ExampleBirthdayCheryl.html#initialStates"><span class="hs-identifier hs-var">initialStates</span></a></span><span class="hs-special">]</span><span>  </span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | combines  S(i) into disjunction: \/{phi(0), phi(1), ...} </span><span>
</span><span id="line-77"></span><span class="hs-comment">-- phi is now a disjuction of conjunctions</span><span>
</span><span id="line-78"></span><span class="annot"><a href="ExampleBirthdayCheryl.html#phi"><span class="hs-identifier hs-type">phi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#FOLFormula"><span class="hs-identifier hs-type">FOLFormula</span></a></span><span>
</span><span id="line-79"></span><span id="phi"><span class="annot"><span class="annottext">phi :: FOLFormula
</span><a href="ExampleBirthdayCheryl.html#phi"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FOLFormula] -&gt; FOLFormula
forall t. [Formula t] -&gt; Formula t
</span><a href="Logics.html#Disj"><span class="hs-identifier hs-var">Disj</span></a></span><span> </span><span class="annot"><span class="annottext">[FOLFormula]
</span><a href="ExampleBirthdayCheryl.html#phis"><span class="hs-identifier hs-var">phis</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | First announcement by Albert</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- @kv x@ means knowing the value of @x@, defined as a disjunction in &quot;Logics&quot;</span><span>
</span><span id="line-83"></span><span id="annAlbert1"><span class="annot"><span class="annottext">annAlbert1 :: Formula Modal
</span><a href="ExampleBirthdayCheryl.html#annAlbert1"><span class="hs-identifier hs-var hs-var">annAlbert1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Formula Modal] -&gt; Formula Modal
forall t. [Formula t] -&gt; Formula t
</span><a href="Logics.html#Conj"><span class="hs-identifier hs-var">Conj</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Formula Modal -&gt; Formula Modal
forall t. Formula t -&gt; Formula t
</span><a href="Logics.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Agent -&gt; Var -&gt; Formula Modal
</span><a href="Logics.html#kv"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="ExampleBirthdayCheryl.html#albert"><span class="hs-identifier hs-var">albert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Agent -&gt; Formula Modal -&gt; Formula Modal
</span><a href="Logics.html#K"><span class="hs-identifier hs-var">K</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="ExampleBirthdayCheryl.html#albert"><span class="hs-identifier hs-var">albert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Formula Modal -&gt; Formula Modal
forall t. Formula t -&gt; Formula t
</span><a href="Logics.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Agent -&gt; Var -&gt; Formula Modal
</span><a href="Logics.html#kv"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="ExampleBirthdayCheryl.html#bernard"><span class="hs-identifier hs-var">bernard</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-84"></span><span id="annBernard"><span class="annot"><span class="annottext">annBernard :: Formula Modal
</span><a href="ExampleBirthdayCheryl.html#annBernard"><span class="hs-identifier hs-var hs-var">annBernard</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Agent -&gt; Var -&gt; Formula Modal
</span><a href="Logics.html#kv"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="ExampleBirthdayCheryl.html#bernard"><span class="hs-identifier hs-var">bernard</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span> </span><span>
</span><span id="line-85"></span><span id="annAlbert2"><span class="annot"><span class="annottext">annAlbert2 :: Formula Modal
</span><a href="ExampleBirthdayCheryl.html#annAlbert2"><span class="hs-identifier hs-var hs-var">annAlbert2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Agent -&gt; Var -&gt; Formula Modal
</span><a href="Logics.html#kv"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="ExampleBirthdayCheryl.html#albert"><span class="hs-identifier hs-var">albert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span id="progC"><span class="annot"><span class="annottext">progC :: Prog
</span><a href="ExampleBirthdayCheryl.html#progC"><span class="hs-identifier hs-var hs-var">progC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Prog] -&gt; Prog
</span><a href="Logics.html#Sequence"><span class="hs-identifier hs-var">Sequence</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Formula Modal -&gt; Prog
</span><a href="Logics.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">Formula Modal
</span><a href="ExampleBirthdayCheryl.html#annAlbert1"><span class="hs-identifier hs-var">annAlbert1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Formula Modal -&gt; Prog
</span><a href="Logics.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">Formula Modal
</span><a href="ExampleBirthdayCheryl.html#annBernard"><span class="hs-identifier hs-var">annBernard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Formula Modal -&gt; Prog
</span><a href="Logics.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">Formula Modal
</span><a href="ExampleBirthdayCheryl.html#annAlbert2"><span class="hs-identifier hs-var">annAlbert2</span></a></span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-88"></span><span id="boxFormula"><span class="annot"><span class="annottext">boxFormula :: Formula Modal
</span><a href="ExampleBirthdayCheryl.html#boxFormula"><span class="hs-identifier hs-var hs-var">boxFormula</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Formula Modal -&gt; Formula Modal
</span><a href="Logics.html#Box"><span class="hs-identifier hs-var">Box</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="ExampleBirthdayCheryl.html#progC"><span class="hs-identifier hs-var">progC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BExpr -&gt; Formula Modal
forall t. BExpr -&gt; Formula t
</span><a href="Logics.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; BExpr
</span><a href="Logics.html#B"><span class="hs-identifier hs-var">B</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- boxFormula = Box (Sequence [Assert annAlbert1, Assert annBernard]) (kv albert day) --equivalently</span><span>
</span><span id="line-90"></span><span id="cherylsBirthday"><span class="annot"><span class="annottext">cherylsBirthday :: IO AllSatResult
</span><a href="ExampleBirthdayCheryl.html#cherylsBirthday"><span class="hs-identifier hs-var hs-var">cherylsBirthday</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Predicate -&gt; IO AllSatResult
forall a. Provable a =&gt; a -&gt; IO AllSatResult
</span><span class="hs-identifier hs-var">allSat</span></span><span> </span><span class="annot"><span class="annottext">(Predicate -&gt; IO AllSatResult) -&gt; Predicate -&gt; IO AllSatResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; FOLFormula -&gt; FOLFormula -&gt; Predicate
</span><a href="ToSBV.html#toSBV"><span class="hs-identifier hs-var">toSBV</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleBirthdayCheryl.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FOLFormula -&gt; Formula Modal -&gt; FOLFormula
forall a. FOLFormula -&gt; Formula a -&gt; FOLFormula
</span><a href="Translation.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleBirthdayCheryl.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Formula Modal
</span><a href="ExampleBirthdayCheryl.html#boxFormula"><span class="hs-identifier hs-var">boxFormula</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- ^ cherylsBirthday find the satisfiability set for the puzzle.</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- This function uses &quot;SBV&quot; to check satisfiability set of the</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- Box-Modal &quot;Logic&quot; formula @['annAlbert1'?; 'annBernard'?; 'annAlbert2'?] True@</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- (or equivalently @['annAlbert1'?; 'annBernard'?] kv albert day@).</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- The formula is first translated into First-Order Logic with &quot;Tau&quot;</span><span>
</span><span id="line-96"></span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- &gt;&gt;&gt; cherylsBirthday</span><span>
</span><span id="line-98"></span><span class="hs-comment">--     Solution #1:</span><span>
</span><span id="line-99"></span><span class="hs-comment">--       month =  7 :: Integer</span><span>
</span><span id="line-100"></span><span class="hs-comment">--       day   = 16 :: Integer</span><span>
</span><span id="line-101"></span><span class="hs-comment">--     This is the only solution.</span><span>
</span><span id="line-102"></span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- The actual solution of the puzzle</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="boxFormulaOriginal"><span class="annot"><span class="annottext">boxFormulaOriginal :: Formula Modal
</span><a href="ExampleBirthdayCheryl.html#boxFormulaOriginal"><span class="hs-identifier hs-var hs-var">boxFormulaOriginal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Formula Modal -&gt; Formula Modal
</span><a href="Logics.html#Box"><span class="hs-identifier hs-var">Box</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Formula Modal -&gt; Prog
</span><a href="Logics.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">(Formula Modal -&gt; Prog) -&gt; Formula Modal -&gt; Prog
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Formula Modal] -&gt; Formula Modal
forall t. [Formula t] -&gt; Formula t
</span><a href="Logics.html#Conj"><span class="hs-identifier hs-var">Conj</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Formula Modal -&gt; Formula Modal
forall t. Formula t -&gt; Formula t
</span><a href="Logics.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Agent -&gt; Var -&gt; Formula Modal
</span><a href="Logics.html#kv"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="ExampleBirthdayCheryl.html#bernard"><span class="hs-identifier hs-var">bernard</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Formula Modal -&gt; Formula Modal
</span><a href="Logics.html#Box"><span class="hs-identifier hs-var">Box</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Formula Modal -&gt; Prog
</span><a href="Logics.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">Formula Modal
</span><a href="ExampleBirthdayCheryl.html#annAlbert1"><span class="hs-identifier hs-var">annAlbert1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Agent -&gt; Var -&gt; Formula Modal
</span><a href="Logics.html#kv"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="ExampleBirthdayCheryl.html#bernard"><span class="hs-identifier hs-var">bernard</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Agent -&gt; Var -&gt; Formula Modal
</span><a href="Logics.html#kv"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="ExampleBirthdayCheryl.html#albert"><span class="hs-identifier hs-var">albert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-106"></span><span id="cherylsBirthdayOriginal"><span class="annot"><span class="annottext">cherylsBirthdayOriginal :: IO AllSatResult
</span><a href="ExampleBirthdayCheryl.html#cherylsBirthdayOriginal"><span class="hs-identifier hs-var hs-var">cherylsBirthdayOriginal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Predicate -&gt; IO AllSatResult
forall a. Provable a =&gt; a -&gt; IO AllSatResult
</span><span class="hs-identifier hs-var">allSat</span></span><span> </span><span class="annot"><span class="annottext">(Predicate -&gt; IO AllSatResult) -&gt; Predicate -&gt; IO AllSatResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; FOLFormula -&gt; FOLFormula -&gt; Predicate
</span><a href="ToSBV.html#toSBV"><span class="hs-identifier hs-var">toSBV</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleBirthdayCheryl.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FOLFormula -&gt; Formula Modal -&gt; FOLFormula
forall a. FOLFormula -&gt; Formula a -&gt; FOLFormula
</span><a href="Translation.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleBirthdayCheryl.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Formula Modal
</span><a href="ExampleBirthdayCheryl.html#boxFormulaOriginal"><span class="hs-identifier hs-var">boxFormulaOriginal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- ^ cherylsBirthdayOriginal the announcement of Bernard, also include that he didn't know the month before the announcement of Albert </span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span id="progC2"><span class="annot"><span class="annottext">progC2 :: Prog
</span><a href="ExampleBirthdayCheryl.html#progC2"><span class="hs-identifier hs-var hs-var">progC2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Formula Modal -&gt; Prog
</span><a href="Logics.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">(Formula Modal -&gt; Prog) -&gt; Formula Modal -&gt; Prog
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BExpr -&gt; Formula Modal
forall t. BExpr -&gt; Formula t
</span><a href="Logics.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Int -&gt; Expr Int -&gt; BExpr
</span><a href="Logics.html#Eq"><span class="hs-identifier hs-var">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Expr Int
</span><a href="Logics.html#IValue"><span class="hs-identifier hs-var">IValue</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr Int
</span><a href="Logics.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">19</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>      </span><span>
</span><span id="line-110"></span><span id="alpha2"><span class="annot"><span class="annottext">alpha2 :: Formula Modal
</span><a href="ExampleBirthdayCheryl.html#alpha2"><span class="hs-identifier hs-var hs-var">alpha2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Agent -&gt; Var -&gt; Formula Modal
</span><a href="Logics.html#kv"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="ExampleBirthdayCheryl.html#bernard"><span class="hs-identifier hs-var">bernard</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span>
</span><span id="line-111"></span><span id="formulaWp2"><span class="annot"><span class="annottext">formulaWp2 :: Formula Modal
</span><a href="ExampleBirthdayCheryl.html#formulaWp2"><span class="hs-identifier hs-var hs-var">formulaWp2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Formula Modal -&gt; Prog -&gt; Formula Modal
</span><a href="Logics.html#wp"><span class="hs-identifier hs-var">wp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Agent -&gt; Var -&gt; Formula Modal
</span><a href="Logics.html#kv"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="ExampleBirthdayCheryl.html#bernard"><span class="hs-identifier hs-var">bernard</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="ExampleBirthdayCheryl.html#progC2"><span class="hs-identifier hs-var">progC2</span></a></span><span>
</span><span id="line-112"></span><span id="cherylsBirthday2"><span class="annot"><span class="annottext">cherylsBirthday2 :: IO AllSatResult
</span><a href="ExampleBirthdayCheryl.html#cherylsBirthday2"><span class="hs-identifier hs-var hs-var">cherylsBirthday2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Predicate -&gt; IO AllSatResult
forall a. Provable a =&gt; a -&gt; IO AllSatResult
</span><span class="hs-identifier hs-var">allSat</span></span><span> </span><span class="annot"><span class="annottext">(Predicate -&gt; IO AllSatResult) -&gt; Predicate -&gt; IO AllSatResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; FOLFormula -&gt; FOLFormula -&gt; Predicate
</span><a href="ToSBV.html#toSBV"><span class="hs-identifier hs-var">toSBV</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleBirthdayCheryl.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FOLFormula -&gt; Formula Modal -&gt; FOLFormula
forall a. FOLFormula -&gt; Formula a -&gt; FOLFormula
</span><a href="Translation.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleBirthdayCheryl.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Formula Modal
</span><a href="ExampleBirthdayCheryl.html#formulaWp2"><span class="hs-identifier hs-var">formulaWp2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- ^ @cherylsBirthday2@ find the satisfiability set for a simplified puzzle </span><span>
</span><span id="line-114"></span><span class="hs-comment">-- with @ProgC2 = (day = 19)?@, check if @[ProgC2] KV_bernard month@ </span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">--  &gt;&gt;&gt; CherylsBirthday2 </span><span>
</span><span id="line-117"></span><span class="hs-comment">-- month =  5 :: Integer</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- day   = 19 :: Integer</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- This is the only solution.</span><span>
</span><span id="line-120"></span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- The actual solution of this instance of the puzzle</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="progC3"><span class="annot"><span class="annottext">progC3 :: Prog
</span><a href="ExampleBirthdayCheryl.html#progC3"><span class="hs-identifier hs-var hs-var">progC3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Formula Modal -&gt; Prog
</span><a href="Logics.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">(Formula Modal -&gt; Prog) -&gt; Formula Modal -&gt; Prog
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BExpr -&gt; Formula Modal
forall t. BExpr -&gt; Formula t
</span><a href="Logics.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Int -&gt; Expr Int -&gt; BExpr
</span><a href="Logics.html#Eq"><span class="hs-identifier hs-var">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Expr Int
</span><a href="Logics.html#IValue"><span class="hs-identifier hs-var">IValue</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr Int
</span><a href="Logics.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">17</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span>
</span><span id="line-124"></span><span id="alpha3"><span class="annot"><span class="annottext">alpha3 :: Formula Modal
</span><a href="ExampleBirthdayCheryl.html#alpha3"><span class="hs-identifier hs-var hs-var">alpha3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Agent -&gt; Var -&gt; Formula Modal
</span><a href="Logics.html#kv"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="ExampleBirthdayCheryl.html#bernard"><span class="hs-identifier hs-var">bernard</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span>
</span><span id="line-125"></span><span id="formulaWp3"><span class="annot"><span class="annottext">formulaWp3 :: Formula Modal
</span><a href="ExampleBirthdayCheryl.html#formulaWp3"><span class="hs-identifier hs-var hs-var">formulaWp3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Formula Modal -&gt; Prog -&gt; Formula Modal
</span><a href="Logics.html#wp"><span class="hs-identifier hs-var">wp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Agent -&gt; Var -&gt; Formula Modal
</span><a href="Logics.html#kv"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="ExampleBirthdayCheryl.html#bernard"><span class="hs-identifier hs-var">bernard</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="ExampleBirthdayCheryl.html#progC3"><span class="hs-identifier hs-var">progC3</span></a></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | @cherylsBirthday3@ find the satisfiability set for a simplified puzzle </span><span>
</span><span id="line-127"></span><span class="hs-comment">-- with @ProgC3 = (day = 17)?@, check if @[ProgC3] KV_bernard month@ </span><span>
</span><span id="line-128"></span><span class="hs-comment">--</span><span>
</span><span id="line-129"></span><span class="hs-comment">--  &gt;&gt;&gt; CherylsBirthday3 </span><span>
</span><span id="line-130"></span><span class="hs-comment">--  No solutions found             </span><span>
</span><span id="line-131"></span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- Because there are two possible months with @day=17@ and bernard cannot distinguish them. </span><span>
</span><span id="line-133"></span><span id="cherylsBirthday3"><span class="annot"><span class="annottext">cherylsBirthday3 :: IO AllSatResult
</span><a href="ExampleBirthdayCheryl.html#cherylsBirthday3"><span class="hs-identifier hs-var hs-var">cherylsBirthday3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Predicate -&gt; IO AllSatResult
forall a. Provable a =&gt; a -&gt; IO AllSatResult
</span><span class="hs-identifier hs-var">allSat</span></span><span> </span><span class="annot"><span class="annottext">(Predicate -&gt; IO AllSatResult) -&gt; Predicate -&gt; IO AllSatResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; FOLFormula -&gt; FOLFormula -&gt; Predicate
</span><a href="ToSBV.html#toSBV"><span class="hs-identifier hs-var">toSBV</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#month"><span class="hs-identifier hs-var">month</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleBirthdayCheryl.html#day"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleBirthdayCheryl.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FOLFormula -&gt; Formula Modal -&gt; FOLFormula
forall a. FOLFormula -&gt; Formula a -&gt; FOLFormula
</span><a href="Translation.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleBirthdayCheryl.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Formula Modal
</span><a href="ExampleBirthdayCheryl.html#formulaWp3"><span class="hs-identifier hs-var">formulaWp3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span></pre></body></html>