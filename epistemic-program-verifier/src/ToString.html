<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -fwarn-incomplete-patterns #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">{-|
Module      : ToString 
Description : To print logical formulas

Printing formulas with quantifiers is not yet implemented.
It is a bit difficult because we use function for quantification
to avoid variable binding problems.
-}</span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">ToString</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Logics.html"><span class="hs-identifier">Logics</span></a></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span id="local-6989586621679066609"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066604"><span id="local-6989586621679066607"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Formula"><span class="hs-identifier hs-type">Formula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066609"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>   </span><span id="local-6989586621679066602"><span class="annot"><span class="annottext">show :: Formula a -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span id="local-6989586621679066600"><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066600"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
forall a. Formula a -&gt; String
</span><a href="ToString.html#toString"><span class="hs-identifier hs-var">toString</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066600"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066594"><span id="local-6989586621679066597"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Logics.html#Var"><span class="hs-identifier hs-type">Var</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>  </span><span id="local-6989586621679066593"><span class="annot"><span class="annottext">show :: Var -&gt; String
</span><a href="#local-6989586621679066593"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span id="local-6989586621679066591"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066591"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066591"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#NVar"><span class="hs-identifier hs-type">NVar</span></a></span><span> </span><span id="local-6989586621679066589"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066589"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066589"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span id="local-6989586621679066588"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066583"><span id="local-6989586621679066586"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066588"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>  </span><span id="local-6989586621679066582"><span class="annot"><span class="annottext">show :: Expr a -&gt; String
</span><a href="#local-6989586621679066582"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#BValue"><span class="hs-identifier hs-type">BValue</span></a></span><span> </span><span id="local-6989586621679066580"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679066580"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679066580"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span id="local-6989586621679066578"><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066578"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679066577"><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066577"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066578"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066577"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#LEq"><span class="hs-identifier hs-type">LEq</span></a></span><span> </span><span id="local-6989586621679066575"><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066575"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679066574"><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066574"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066575"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8804;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066574"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Mul"><span class="hs-identifier hs-type">Mul</span></a></span><span> </span><span id="local-6989586621679066572"><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066572"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679066571"><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066571"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066572"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#215;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066571"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span id="local-6989586621679066569"><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066569"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679066568"><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066568"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066569"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066568"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#BEq"><span class="hs-identifier hs-type">BEq</span></a></span><span> </span><span id="local-6989586621679066566"><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066566"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679066565"><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066565"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066566"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066565"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;T&quot;</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;F&quot;</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621679066562"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679066562"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679066562"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#IValue"><span class="hs-identifier hs-type">IValue</span></a></span><span> </span><span id="local-6989586621679066560"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679066560"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679066560"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Xor"><span class="hs-identifier hs-type">Xor</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679066558"><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066558"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066558"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Xor"><span class="hs-identifier hs-type">Xor</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066557"><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066557"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066556"><span class="annot"><span class="annottext">[Expr Bool]
</span><a href="#local-6989586621679066556"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066557"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Expr Bool] -&gt; Expr Bool
</span><a href="Logics.html#Xor"><span class="hs-identifier hs-var">Xor</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr Bool]
</span><a href="#local-6989586621679066556"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Or"><span class="hs-identifier hs-type">Or</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679066554"><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066554"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066554"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Or"><span class="hs-identifier hs-type">Or</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066553"><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066553"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066552"><span class="annot"><span class="annottext">[Expr Bool]
</span><a href="#local-6989586621679066552"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066553"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Expr Bool] -&gt; Expr Bool
</span><a href="Logics.html#Or"><span class="hs-identifier hs-var">Or</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr Bool]
</span><a href="#local-6989586621679066552"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#And"><span class="hs-identifier hs-type">And</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679066550"><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066550"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066550"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#And"><span class="hs-identifier hs-type">And</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066549"><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066549"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066548"><span class="annot"><span class="annottext">[Expr Bool]
</span><a href="#local-6989586621679066548"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066549"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Expr Bool] -&gt; Expr Bool
</span><a href="Logics.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr Bool]
</span><a href="#local-6989586621679066548"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span></span><span> </span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066543"><span id="local-6989586621679066546"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Logics.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-42"></span><span>  </span><span id="local-6989586621679066542"><span class="annot"><span class="annottext">show :: Prog -&gt; String
</span><a href="#local-6989586621679066542"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog
</span><a href="Logics.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Skip&quot;</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span id="local-6989586621679066539"><span class="annot"><span class="annottext">ModalFormula
</span><a href="#local-6989586621679066539"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModalFormula -&gt; String
forall a. Formula a -&gt; String
</span><a href="ToString.html#toString"><span class="hs-identifier hs-var">toString</span></a></span><span> </span><span class="annot"><span class="annottext">ModalFormula
</span><a href="#local-6989586621679066539"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;?&quot;</span></span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#NAssign"><span class="hs-identifier hs-type">NAssign</span></a></span><span> </span><span id="local-6989586621679066537"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679066537"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679066536"><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066536"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679066537"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066536"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#BAssign"><span class="hs-identifier hs-type">BAssign</span></a></span><span> </span><span id="local-6989586621679066534"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679066534"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679066533"><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066533"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679066534"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066533"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Sequence"><span class="hs-identifier hs-type">Sequence</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Sequence"><span class="hs-identifier hs-type">Sequence</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679066531"><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066531"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066531"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Sequence"><span class="hs-identifier hs-type">Sequence</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066530"><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066530"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066529"><span class="annot"><span class="annottext">[Prog]
</span><a href="#local-6989586621679066529"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066530"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Prog] -&gt; Prog
</span><a href="Logics.html#Sequence"><span class="hs-identifier hs-var">Sequence</span></a></span><span> </span><span class="annot"><span class="annottext">[Prog]
</span><a href="#local-6989586621679066529"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Nondet"><span class="hs-identifier hs-type">Nondet</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Nondet"><span class="hs-identifier hs-type">Nondet</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679066527"><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066527"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066527"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#Nondet"><span class="hs-identifier hs-type">Nondet</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066526"><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066526"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066525"><span class="annot"><span class="annottext">[Prog]
</span><a href="#local-6989586621679066525"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066526"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8851;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Prog] -&gt; Prog
</span><a href="Logics.html#Sequence"><span class="hs-identifier hs-var">Sequence</span></a></span><span> </span><span class="annot"><span class="annottext">[Prog]
</span><a href="#local-6989586621679066525"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logics.html#IfElse"><span class="hs-identifier hs-type">IfElse</span></a></span><span> </span><span id="local-6989586621679066523"><span class="annot"><span class="annottext">ModalFormula
</span><a href="#local-6989586621679066523"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679066522"><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066522"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679066521"><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066521"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066522"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;if&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ModalFormula -&gt; String
forall a. Formula a -&gt; String
</span><a href="ToString.html#toString"><span class="hs-identifier hs-var">toString</span></a></span><span> </span><span class="annot"><span class="annottext">ModalFormula
</span><a href="#local-6989586621679066523"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;else&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066521"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span>
</span><span id="line-53"></span><span class="hs-comment">-- precedence rules to decide parentheses</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- </span><span>
</span><span id="line-55"></span><span id="local-6989586621679066614"><span class="annot"><a href="ToString.html#precedence"><span class="hs-identifier hs-type">precedence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#Formula"><span class="hs-identifier hs-type">Formula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066614"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-56"></span><span id="precedence"><span class="annot"><span class="annottext">precedence :: Formula t -&gt; Int
</span><a href="ToString.html#precedence"><span class="hs-identifier hs-var hs-var">precedence</span></a></span></span><span> </span><span class="annot"><a href="Logics.html#NSub"><span class="hs-identifier hs-type">NSub</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">17</span></span><span>
</span><span id="line-57"></span><span class="annot"><a href="ToString.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><a href="Logics.html#BSub"><span class="hs-identifier hs-type">BSub</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span>
</span><span id="line-58"></span><span class="annot"><a href="ToString.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><a href="Logics.html#ForAllB"><span class="hs-identifier hs-type">ForAllB</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">15</span></span><span>
</span><span id="line-59"></span><span class="annot"><a href="ToString.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><a href="Logics.html#ExistsB"><span class="hs-identifier hs-type">ExistsB</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">14</span></span><span>
</span><span id="line-60"></span><span class="annot"><a href="ToString.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><a href="Logics.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-61"></span><span class="annot"><a href="ToString.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><a href="Logics.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span>
</span><span id="line-62"></span><span class="annot"><a href="ToString.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><a href="Logics.html#K"><span class="hs-identifier hs-type">K</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-63"></span><span class="annot"><a href="ToString.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><a href="Logics.html#Box"><span class="hs-identifier hs-type">Box</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-64"></span><span class="annot"><a href="ToString.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><a href="Logics.html#Disj"><span class="hs-identifier hs-type">Disj</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-65"></span><span class="annot"><a href="ToString.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><a href="Logics.html#Conj"><span class="hs-identifier hs-type">Conj</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-66"></span><span class="annot"><a href="ToString.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><a href="Logics.html#Imp"><span class="hs-identifier hs-type">Imp</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-67"></span><span class="annot"><a href="ToString.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><a href="Logics.html#Equiv"><span class="hs-identifier hs-type">Equiv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- precedence rules for numberical expressions</span><span>
</span><span id="line-70"></span><span class="annot"><a href="ToString.html#precedenceNE"><span class="hs-identifier hs-type">precedenceNE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-71"></span><span id="precedenceNE"><span class="annot"><span class="annottext">precedenceNE :: Expr Int -&gt; Int
</span><a href="ToString.html#precedenceNE"><span class="hs-identifier hs-var hs-var">precedenceNE</span></a></span></span><span> </span><span class="annot"><a href="Logics.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-72"></span><span class="annot"><a href="ToString.html#precedenceNE"><span class="hs-identifier hs-var">precedenceNE</span></a></span><span> </span><span class="annot"><a href="Logics.html#IValue"><span class="hs-identifier hs-type">IValue</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-73"></span><span class="annot"><a href="ToString.html#precedenceNE"><span class="hs-identifier hs-var">precedenceNE</span></a></span><span> </span><span class="annot"><a href="Logics.html#Mul"><span class="hs-identifier hs-type">Mul</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-74"></span><span class="annot"><a href="ToString.html#precedenceNE"><span class="hs-identifier hs-var">precedenceNE</span></a></span><span> </span><span class="annot"><a href="Logics.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | The main function takes any formula ('FOLFormula' or 'ModalFormula') </span><span>
</span><span id="line-77"></span><span class="hs-comment">-- and returns a string. The output string is formatted to be parsable by Python.</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- The plan is to use SymPy to remove redundant tautologies.</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- The elimination of the annouce logical operator exploded the size of the formula.</span><span>
</span><span id="line-80"></span><span id="local-6989586621679066505"><span class="annot"><a href="ToString.html#toString"><span class="hs-identifier hs-type">toString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#Formula"><span class="hs-identifier hs-type">Formula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066505"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-81"></span><span id="toString"><span class="annot"><span class="annottext">toString :: Formula a -&gt; String
</span><a href="ToString.html#toString"><span class="hs-identifier hs-var hs-var">toString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Formula a -&gt; String
forall a. Int -&gt; Formula a -&gt; String
</span><a href="ToString.html#toStringPrec"><span class="hs-identifier hs-var">toStringPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-82"></span><span class="hs-comment">--</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- toStringNExprPrec :: Int -&gt; NExpr -&gt; String</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- toStringNExprPrec dCntxt f = bracket unbracketed where</span><span>
</span><span id="line-85"></span><span class="hs-comment">--     dHere       = precedenceNE f</span><span>
</span><span id="line-86"></span><span class="hs-comment">--     recurse     = toStringNExprPrec dHere</span><span>
</span><span id="line-87"></span><span class="hs-comment">--     unbracketed = case f of</span><span>
</span><span id="line-88"></span><span class="hs-comment">--         IValue (NVar v)  -&gt; v</span><span>
</span><span id="line-89"></span><span class="hs-comment">--         I n -&gt; show n </span><span>
</span><span id="line-90"></span><span class="hs-comment">--         Add e1 e2 -&gt; recurse e1 ++ &quot; + &quot; ++ recurse e2</span><span>
</span><span id="line-91"></span><span class="hs-comment">--         Mul e1 e2 -&gt; recurse e1 ++ &quot; * &quot; ++ recurse e2</span><span>
</span><span id="line-92"></span><span class="hs-comment">--     bracket</span><span>
</span><span id="line-93"></span><span class="hs-comment">--         | dCntxt &gt; dHere = \s -&gt; &quot;(&quot; ++ s ++ &quot;)&quot;</span><span>
</span><span id="line-94"></span><span class="hs-comment">--         | otherwise      = id</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- toStringNExpr :: NExpr -&gt; String</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- toStringNExpr = toStringNExprPrec 0</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span id="local-6989586621679066616"><span class="annot"><a href="ToString.html#toStringPrec"><span class="hs-identifier hs-type">toStringPrec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logics.html#Formula"><span class="hs-identifier hs-type">Formula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066616"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-101"></span><span id="toStringPrec"><span class="annot"><span class="annottext">toStringPrec :: Int -&gt; Formula a -&gt; String
</span><a href="ToString.html#toStringPrec"><span class="hs-identifier hs-var hs-var">toStringPrec</span></a></span></span><span> </span><span id="local-6989586621679066503"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066503"><span class="hs-identifier hs-var">dCntxt</span></a></span></span><span> </span><span id="local-6989586621679066502"><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066502"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679066501"><span class="hs-identifier hs-var">bracket</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066500"><span class="hs-identifier hs-var">unbracketed</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679066499"><span class="annot"><span class="annottext">dHere :: Int
</span><a href="#local-6989586621679066499"><span class="hs-identifier hs-var hs-var">dHere</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; Int
forall t. Formula t -&gt; Int
</span><a href="ToString.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066502"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679066498"><span class="annot"><span class="annottext">recurse :: Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var hs-var">recurse</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Formula a -&gt; String
forall a. Int -&gt; Formula a -&gt; String
</span><a href="ToString.html#toStringPrec"><span class="hs-identifier hs-var">toStringPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066499"><span class="hs-identifier hs-var">dHere</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679066500"><span class="annot"><span class="annottext">unbracketed :: String
</span><a href="#local-6989586621679066500"><span class="hs-identifier hs-var hs-var">unbracketed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066502"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><a href="Logics.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span><span> </span><span id="local-6989586621679066497"><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066497"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066497"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-106"></span><span>        </span><span class="hs-comment">-- Atom (B t)    -&gt; show t</span><span>
</span><span id="line-107"></span><span>        </span><span class="hs-comment">-- Atom (BValue (BVar b))    -&gt; b </span><span>
</span><span id="line-108"></span><span>        </span><span class="hs-comment">-- Atom (BValue (NVar x))   -&gt; x </span><span>
</span><span id="line-109"></span><span>        </span><span class="hs-comment">-- Atom (Xor []) -&gt; &quot;&quot;</span><span>
</span><span id="line-110"></span><span>        </span><span class="hs-comment">-- Atom (Xor (b:bs)) -&gt; recurse (Atom b) ++ &quot;^&quot; ++  recurse (Atom (Xor bs))</span><span>
</span><span id="line-111"></span><span>        </span><span class="hs-comment">-- Atom (And []) -&gt; &quot;&quot;</span><span>
</span><span id="line-112"></span><span>        </span><span class="hs-comment">-- Atom (And (b:bs)) -&gt; recurse (Atom b) ++ &quot;&#8743;&quot; ++  recurse (Atom (And bs))</span><span>
</span><span id="line-113"></span><span>        </span><span class="hs-comment">-- Atom (Or []) -&gt; &quot;&quot;</span><span>
</span><span id="line-114"></span><span>        </span><span class="hs-comment">-- Atom (Or (b:bs)) -&gt; recurse (Atom b) ++ &quot;&#8744;&quot; ++  recurse (Atom (Or bs))</span><span>
</span><span id="line-115"></span><span>        </span><span class="hs-comment">-- -- Atom (Xor (bs))  -&gt; &quot;Xor(&quot; ++ separateWithCommas [recurse (Atom b) | b &lt;- bs]  ++ &quot;)&quot;</span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-comment">-- -- Atom (And (bs))  -&gt; &quot;And(&quot; ++ separateWithCommas [recurse (Atom b) | b &lt;- bs]  ++ &quot;)&quot;</span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-comment">-- -- Atom (Or (bs))  -&gt; &quot;And(&quot; ++ separateWithCommas [recurse (Atom b) | b &lt;- bs]  ++ &quot;)&quot;</span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-comment">-- Atom (Eq e1 e2)    -&gt; toStringNExpr e1 ++ &quot; = &quot; ++ toStringNExpr e2</span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-comment">-- Atom (LEq e1 e2)    -&gt; toStringNExpr e1 ++ &quot; &lt;= &quot; ++ toStringNExpr e2</span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-comment">-- Atom (BEq e1 e2)    -&gt; recurse (Atom e1) ++ &quot; = &quot; ++ recurse (Atom e2)</span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><a href="Logics.html#K"><span class="hs-identifier hs-type">K</span></a></span><span> </span><span id="local-6989586621679066496"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679066496"><span class="hs-identifier hs-var">ag</span></a></span></span><span> </span><span id="local-6989586621679066495"><span class="annot"><span class="annottext">ModalFormula
</span><a href="#local-6989586621679066495"><span class="hs-identifier hs-var">p</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;K_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Agent -&gt; Int
</span><a href="Logics.html#identity"><span class="hs-identifier hs-var hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679066496"><span class="hs-identifier hs-var">ag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
ModalFormula
</span><a href="#local-6989586621679066495"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><a href="Logics.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span id="local-6989586621679066493"><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066493"><span class="hs-identifier hs-var">p</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;~&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066493"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><a href="Logics.html#Conj"><span class="hs-identifier hs-type">Conj</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;T&quot;</span></span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><a href="Logics.html#Disj"><span class="hs-identifier hs-type">Disj</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;F&quot;</span></span><span> </span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><a href="Logics.html#Conj"><span class="hs-identifier hs-type">Conj</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679066492"><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066492"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066492"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><a href="Logics.html#Disj"><span class="hs-identifier hs-type">Disj</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679066491"><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066491"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066491"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><a href="Logics.html#Conj"><span class="hs-identifier hs-type">Conj</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066490"><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066490"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066489"><span class="annot"><span class="annottext">[Formula a]
</span><a href="#local-6989586621679066489"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066490"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &amp; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Formula a] -&gt; Formula a
forall t. [Formula t] -&gt; Formula t
</span><a href="Logics.html#Conj"><span class="hs-identifier hs-var">Conj</span></a></span><span> </span><span class="annot"><span class="annottext">[Formula a]
</span><a href="#local-6989586621679066489"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><a href="Logics.html#Disj"><span class="hs-identifier hs-type">Disj</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066488"><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066488"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066487"><span class="annot"><span class="annottext">[Formula a]
</span><a href="#local-6989586621679066487"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066488"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; | &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Formula a] -&gt; Formula a
forall t. [Formula t] -&gt; Formula t
</span><a href="Logics.html#Disj"><span class="hs-identifier hs-var">Disj</span></a></span><span> </span><span class="annot"><span class="annottext">[Formula a]
</span><a href="#local-6989586621679066487"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><a href="Logics.html#Imp"><span class="hs-identifier hs-type">Imp</span></a></span><span> </span><span id="local-6989586621679066486"><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066486"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679066485"><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066485"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066486"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; =&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066485"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><a href="Logics.html#Equiv"><span class="hs-identifier hs-type">Equiv</span></a></span><span> </span><span id="local-6989586621679066484"><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066484"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679066483"><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066483"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066484"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &lt;=&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066483"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><a href="Logics.html#Box"><span class="hs-identifier hs-type">Box</span></a></span><span> </span><span id="local-6989586621679066482"><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066482"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span id="local-6989586621679066481"><span class="annot"><span class="annottext">ModalFormula
</span><a href="#local-6989586621679066481"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621679066482"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
ModalFormula
</span><a href="#local-6989586621679066481"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><a href="Logics.html#ExistsB"><span class="hs-identifier hs-type">ExistsB</span></a></span><span> </span><span id="local-6989586621679066480"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066480"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679066479"><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066479"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;E y&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066480"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066479"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><a href="Logics.html#ForAllB"><span class="hs-identifier hs-type">ForAllB</span></a></span><span> </span><span id="local-6989586621679066478"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066478"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679066477"><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066477"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;A u&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066478"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
</span><a href="#local-6989586621679066477"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><a href="Logics.html#NSub"><span class="hs-identifier hs-type">NSub</span></a></span><span> </span><span id="local-6989586621679066476"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679066476"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679066475"><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066475"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679066474"><span class="annot"><span class="annottext">ModalFormula
</span><a href="#local-6989586621679066474"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
ModalFormula
</span><a href="#local-6989586621679066474"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679066476"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Int
</span><a href="#local-6989586621679066475"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><a href="Logics.html#BSub"><span class="hs-identifier hs-type">BSub</span></a></span><span> </span><span id="local-6989586621679066473"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679066473"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679066472"><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066472"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679066471"><span class="annot"><span class="annottext">ModalFormula
</span><a href="#local-6989586621679066471"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Formula a -&gt; String
</span><a href="#local-6989586621679066498"><span class="hs-identifier hs-var">recurse</span></a></span><span> </span><span class="annot"><span class="annottext">Formula a
ModalFormula
</span><a href="#local-6989586621679066471"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621679066473"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Expr Bool
</span><a href="#local-6989586621679066472"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621679066501"><span class="annot"><span class="annottext">bracket :: ShowS
</span><a href="#local-6989586621679066501"><span class="hs-identifier hs-var hs-var">bracket</span></a></span></span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066503"><span class="hs-identifier hs-var">dCntxt</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066499"><span class="hs-identifier hs-var">dHere</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679066469"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066469"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066469"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-138"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><a href="ToString.html#separateWithCommas"><span class="hs-identifier hs-type">separateWithCommas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-142"></span><span id="separateWithCommas"><span class="annot"><span class="annottext">separateWithCommas :: [String] -&gt; String
</span><a href="ToString.html#separateWithCommas"><span class="hs-identifier hs-var hs-var">separateWithCommas</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679066466"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066466"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066466"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-143"></span><span class="annot"><a href="ToString.html#separateWithCommas"><span class="hs-identifier hs-var">separateWithCommas</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066465"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066465"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066464"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679066464"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066465"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="ToString.html#separateWithCommas"><span class="hs-identifier hs-var">separateWithCommas</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679066464"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-144"></span><span class="annot"><a href="ToString.html#separateWithCommas"><span class="hs-identifier hs-var">separateWithCommas</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-145"></span></pre></body></html>