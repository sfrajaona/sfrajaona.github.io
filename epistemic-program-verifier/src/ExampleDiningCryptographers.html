<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : ExampleDiningCryptographers
Description : Implementation  of Chaum's Dining Cryptographers algorithm
Copyright   :
License     : 
Maintainer  : Anonymous
Portability : 
Stability   : 

@n@ agents dine at a round table [Chaum, 1988]. 
The dinner may have been paid by their employer (the NSA), or by one of the agents. 
They execute a protocol to reveal whether one of the agents paid, but without revealing which one. 
The protocol supplies each pair of adjacent agents with a random coin, which can be observed only by that pair. Each agent announces the result of XORing three Booleans: the two coins observable by her and the status of whether she paid for the dinner. The XOR of all announcements is proven to be equal to the disjunction of whether any agent paid.

-}</span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">ExampleDiningCryptographers</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.SBV</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Logics.html"><span class="hs-identifier">Logics</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Translation.html"><span class="hs-identifier">Translation</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ToSBV.html"><span class="hs-identifier">ToSBV</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ToString.html"><span class="hs-identifier">ToString</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- | @ag i@ characterised by its identity @i@ and its nonobservable variables</span><span>
</span><span id="line-27"></span><span class="annot"><a href="ExampleDiningCryptographers.html#ag"><span class="hs-identifier hs-type">ag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logics.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span>
</span><span id="line-28"></span><span id="ag"><span class="annot"><span class="annottext">ag :: Int -&gt; Agent
</span><a href="ExampleDiningCryptographers.html#ag"><span class="hs-identifier hs-var hs-var">ag</span></a></span></span><span> </span><span id="local-6989586621679066850"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066850"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Agent :: Int -&gt; [Var] -&gt; Agent
</span><a href="Logics.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">identity :: Int
</span><a href="Logics.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066850"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nonobs :: [Var]
</span><a href="Logics.html#nonobs"><span class="hs-identifier hs-var">nonobs</span></a></span><span class="hs-glyph">=</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="ExampleDiningCryptographers.html#allVars"><span class="hs-identifier hs-var">allVars</span></a></span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Var]
</span><a href="ExampleDiningCryptographers.html#obs"><span class="hs-identifier hs-var">obs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066850"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">}</span><span> </span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- | all variables</span><span>
</span><span id="line-31"></span><span class="annot"><a href="ExampleDiningCryptographers.html#allVars"><span class="hs-identifier hs-type">allVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logics.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-32"></span><span id="allVars"><span class="annot"><span class="annottext">allVars :: [Var]
</span><a href="ExampleDiningCryptographers.html#allVars"><span class="hs-identifier hs-var hs-var">allVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleDiningCryptographers.html#varx"><span class="hs-identifier hs-var">varx</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[Var]] -&gt; [Var]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Var
</span><a href="ExampleDiningCryptographers.html#varc"><span class="hs-identifier hs-var">varc</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066840"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Var
</span><a href="ExampleDiningCryptographers.html#varp"><span class="hs-identifier hs-var">varp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066840"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679066840"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066840"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="ExampleDiningCryptographers.html#n"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | observability function, \(ag_i\) observes \(x, p_i, c_i, c_{i+1 \mod n}\), </span><span>
</span><span id="line-35"></span><span class="annot"><a href="ExampleDiningCryptographers.html#obs"><span class="hs-identifier hs-type">obs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logics.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-36"></span><span id="obs"><span class="annot"><span class="annottext">obs :: Int -&gt; [Var]
</span><a href="ExampleDiningCryptographers.html#obs"><span class="hs-identifier hs-var hs-var">obs</span></a></span></span><span> </span><span id="local-6989586621679066837"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066837"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="ExampleDiningCryptographers.html#varx"><span class="hs-identifier hs-var">varx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Var
</span><a href="ExampleDiningCryptographers.html#varp"><span class="hs-identifier hs-var">varp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066837"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Var
</span><a href="ExampleDiningCryptographers.html#varc"><span class="hs-identifier hs-var">varc</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066837"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Var
</span><a href="ExampleDiningCryptographers.html#varc"><span class="hs-identifier hs-var">varc</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Var) -&gt; Int -&gt; Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066837"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="ExampleDiningCryptographers.html#n"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- | boolean variable \(x\)</span><span>
</span><span id="line-39"></span><span class="annot"><a href="ExampleDiningCryptographers.html#varx"><span class="hs-identifier hs-type">varx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-40"></span><span id="varx"><span class="annot"><span class="annottext">varx :: Var
</span><a href="ExampleDiningCryptographers.html#varx"><span class="hs-identifier hs-var hs-var">varx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Logics.html#BVar"><span class="hs-identifier hs-var">BVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span> </span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- | boolean expression x</span><span>
</span><span id="line-43"></span><span class="annot"><a href="ExampleDiningCryptographers.html#x"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#BExpr"><span class="hs-identifier hs-type">BExpr</span></a></span><span>
</span><span id="line-44"></span><span id="x"><span class="annot"><span class="annottext">x :: BExpr
</span><a href="ExampleDiningCryptographers.html#x"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; BExpr
</span><a href="Logics.html#BValue"><span class="hs-identifier hs-var">BValue</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleDiningCryptographers.html#varx"><span class="hs-identifier hs-var">varx</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | boolean variable \(c_i\) coin flip between agent i and agent i-1</span><span>
</span><span id="line-47"></span><span class="annot"><a href="ExampleDiningCryptographers.html#varc"><span class="hs-identifier hs-type">varc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logics.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-48"></span><span id="varc"><span class="annot"><span class="annottext">varc :: Int -&gt; Var
</span><a href="ExampleDiningCryptographers.html#varc"><span class="hs-identifier hs-var hs-var">varc</span></a></span></span><span> </span><span id="local-6989586621679066831"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066831"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Logics.html#BVar"><span class="hs-identifier hs-var">BVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;c&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066831"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | boolean variable \(p_i\) agent i paid</span><span>
</span><span id="line-51"></span><span class="annot"><a href="ExampleDiningCryptographers.html#varp"><span class="hs-identifier hs-type">varp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logics.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-52"></span><span id="varp"><span class="annot"><span class="annottext">varp :: Int -&gt; Var
</span><a href="ExampleDiningCryptographers.html#varp"><span class="hs-identifier hs-var hs-var">varp</span></a></span></span><span> </span><span id="local-6989586621679066829"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066829"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Logics.html#BVar"><span class="hs-identifier hs-var">BVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;p&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066829"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | boolean expression \(p_i\)</span><span>
</span><span id="line-55"></span><span class="annot"><a href="ExampleDiningCryptographers.html#p"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logics.html#BExpr"><span class="hs-identifier hs-type">BExpr</span></a></span><span>
</span><span id="line-56"></span><span id="p"><span class="annot"><span class="annottext">p :: Int -&gt; BExpr
</span><a href="ExampleDiningCryptographers.html#p"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679066827"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066827"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; BExpr
</span><a href="Logics.html#BValue"><span class="hs-identifier hs-var">BValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; BExpr) -&gt; Var -&gt; BExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Var
</span><a href="ExampleDiningCryptographers.html#varp"><span class="hs-identifier hs-var">varp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066827"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-57"></span><span> </span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | boolean expression \(c_i\)</span><span>
</span><span id="line-59"></span><span class="annot"><a href="ExampleDiningCryptographers.html#c"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logics.html#BExpr"><span class="hs-identifier hs-type">BExpr</span></a></span><span>
</span><span id="line-60"></span><span id="c"><span class="annot"><span class="annottext">c :: Int -&gt; BExpr
</span><a href="ExampleDiningCryptographers.html#c"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679066825"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066825"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; BExpr
</span><a href="Logics.html#BValue"><span class="hs-identifier hs-var">BValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; BExpr) -&gt; Var -&gt; BExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Var
</span><a href="ExampleDiningCryptographers.html#varc"><span class="hs-identifier hs-var">varc</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066825"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | \(\phi\) or \(I\) the constraint on the inital states: &quot;that all agents knows that at most one agent paid&quot;</span><span>
</span><span id="line-64"></span><span class="annot"><a href="ExampleDiningCryptographers.html#phi"><span class="hs-identifier hs-type">phi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#FOLFormula"><span class="hs-identifier hs-type">FOLFormula</span></a></span><span>
</span><span id="line-65"></span><span id="phi"><span class="annot"><span class="annottext">phi :: FOLFormula
</span><a href="ExampleDiningCryptographers.html#phi"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FOLFormula] -&gt; FOLFormula
forall t. [Formula t] -&gt; Formula t
</span><a href="Logics.html#Conj"><span class="hs-identifier hs-var">Conj</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FOLFormula -&gt; FOLFormula -&gt; FOLFormula
forall t. Formula t -&gt; Formula t -&gt; Formula t
</span><a href="Logics.html#Imp"><span class="hs-identifier hs-var">Imp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BExpr -&gt; FOLFormula
forall t. BExpr -&gt; Formula t
</span><a href="Logics.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; BExpr
</span><a href="ExampleDiningCryptographers.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066820"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FOLFormula] -&gt; FOLFormula
forall t. [Formula t] -&gt; Formula t
</span><a href="Logics.html#Conj"><span class="hs-identifier hs-var">Conj</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FOLFormula -&gt; FOLFormula
forall t. Formula t -&gt; Formula t
</span><a href="Logics.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BExpr -&gt; FOLFormula
forall t. BExpr -&gt; Formula t
</span><a href="Logics.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; BExpr
</span><a href="ExampleDiningCryptographers.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066818"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679066818"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066818"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066820"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [Int]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066820"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="ExampleDiningCryptographers.html#n"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679066820"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066820"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="ExampleDiningCryptographers.html#n"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | the boolean expression to be assigned to \(x\) in the algorithm</span><span>
</span><span id="line-68"></span><span class="annot"><a href="ExampleDiningCryptographers.html#bexprDC"><span class="hs-identifier hs-type">bexprDC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#BExpr"><span class="hs-identifier hs-type">BExpr</span></a></span><span>
</span><span id="line-69"></span><span id="bexprDC"><span class="annot"><span class="annottext">bexprDC :: BExpr
</span><a href="ExampleDiningCryptographers.html#bexprDC"><span class="hs-identifier hs-var hs-var">bexprDC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BExpr] -&gt; BExpr
</span><a href="Logics.html#Xor"><span class="hs-identifier hs-var">Xor</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[BExpr] -&gt; BExpr
</span><a href="Logics.html#Xor"><span class="hs-identifier hs-var">Xor</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; BExpr
</span><a href="ExampleDiningCryptographers.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066815"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; BExpr
</span><a href="ExampleDiningCryptographers.html#c"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066815"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; BExpr
</span><a href="ExampleDiningCryptographers.html#c"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; BExpr) -&gt; Int -&gt; BExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066815"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="ExampleDiningCryptographers.html#n"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679066815"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066815"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="ExampleDiningCryptographers.html#n"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | the DC algorithm as an assignment to \(x\)</span><span>
</span><span id="line-72"></span><span class="annot"><a href="ExampleDiningCryptographers.html#progDC"><span class="hs-identifier hs-type">progDC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>              </span><span>
</span><span id="line-73"></span><span id="progDC"><span class="annot"><span class="annottext">progDC :: Prog
</span><a href="ExampleDiningCryptographers.html#progDC"><span class="hs-identifier hs-var hs-var">progDC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; BExpr -&gt; Prog
</span><a href="Logics.html#BAssign"><span class="hs-identifier hs-var">BAssign</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="ExampleDiningCryptographers.html#varx"><span class="hs-identifier hs-var">varx</span></a></span><span> </span><span class="annot"><span class="annottext">BExpr
</span><a href="ExampleDiningCryptographers.html#bexprDC"><span class="hs-identifier hs-var">bexprDC</span></a></span><span> </span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | the number of agents</span><span>
</span><span id="line-76"></span><span class="annot"><a href="ExampleDiningCryptographers.html#n"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span>
</span><span id="line-77"></span><span id="n"><span class="annot"><span class="annottext">n :: Int
</span><a href="ExampleDiningCryptographers.html#n"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="annot"><a href="ExampleDiningCryptographers.html#noonepaid"><span class="hs-identifier hs-type">noonepaid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#ModalFormula"><span class="hs-identifier hs-type">ModalFormula</span></a></span><span> </span><span>
</span><span id="line-80"></span><span id="noonepaid"><span class="annot"><span class="annottext">noonepaid :: ModalFormula
</span><a href="ExampleDiningCryptographers.html#noonepaid"><span class="hs-identifier hs-var hs-var">noonepaid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ModalFormula] -&gt; ModalFormula
forall t. [Formula t] -&gt; Formula t
</span><a href="Logics.html#Conj"><span class="hs-identifier hs-var">Conj</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ModalFormula -&gt; ModalFormula
forall t. Formula t -&gt; Formula t
</span><a href="Logics.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BExpr -&gt; ModalFormula
forall t. BExpr -&gt; Formula t
</span><a href="Logics.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; BExpr
</span><a href="ExampleDiningCryptographers.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066811"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679066811"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066811"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="ExampleDiningCryptographers.html#n"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="annot"><a href="ExampleDiningCryptographers.html#dontknowwhopaid"><span class="hs-identifier hs-type">dontknowwhopaid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logics.html#ModalFormula"><span class="hs-identifier hs-type">ModalFormula</span></a></span><span>
</span><span id="line-83"></span><span id="dontknowwhopaid"><span class="annot"><span class="annottext">dontknowwhopaid :: Agent -&gt; ModalFormula
</span><a href="ExampleDiningCryptographers.html#dontknowwhopaid"><span class="hs-identifier hs-var hs-var">dontknowwhopaid</span></a></span></span><span> </span><span id="local-6989586621679066809"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679066809"><span class="hs-identifier hs-var">ag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ModalFormula] -&gt; ModalFormula
forall t. [Formula t] -&gt; Formula t
</span><a href="Logics.html#Conj"><span class="hs-identifier hs-var">Conj</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ModalFormula -&gt; ModalFormula
forall t. Formula t -&gt; Formula t
</span><a href="Logics.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Agent -&gt; ModalFormula -&gt; ModalFormula
</span><a href="Logics.html#K"><span class="hs-identifier hs-var">K</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679066809"><span class="hs-identifier hs-var">ag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BExpr -&gt; ModalFormula
forall t. BExpr -&gt; Formula t
</span><a href="Logics.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; BExpr
</span><a href="ExampleDiningCryptographers.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066807"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679066807"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066807"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="ExampleDiningCryptographers.html#n"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="annot"><a href="ExampleDiningCryptographers.html#alpha1"><span class="hs-identifier hs-type">alpha1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#ModalFormula"><span class="hs-identifier hs-type">ModalFormula</span></a></span><span>
</span><span id="line-86"></span><span id="alpha1"><span class="annot"><span class="annottext">alpha1 :: ModalFormula
</span><a href="ExampleDiningCryptographers.html#alpha1"><span class="hs-identifier hs-var hs-var">alpha1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModalFormula -&gt; ModalFormula -&gt; ModalFormula
forall t. Formula t -&gt; Formula t -&gt; Formula t
</span><a href="Logics.html#Imp"><span class="hs-identifier hs-var">Imp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModalFormula -&gt; ModalFormula
forall t. Formula t -&gt; Formula t
</span><a href="Logics.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BExpr -&gt; ModalFormula
forall t. BExpr -&gt; Formula t
</span><a href="Logics.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; BExpr
</span><a href="ExampleDiningCryptographers.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ModalFormula] -&gt; ModalFormula
forall t. [Formula t] -&gt; Formula t
</span><a href="Logics.html#Disj"><span class="hs-identifier hs-var">Disj</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Agent -&gt; ModalFormula -&gt; ModalFormula
</span><a href="Logics.html#K"><span class="hs-identifier hs-var">K</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Agent
</span><a href="ExampleDiningCryptographers.html#ag"><span class="hs-identifier hs-var">ag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ModalFormula
</span><a href="ExampleDiningCryptographers.html#noonepaid"><span class="hs-identifier hs-var">noonepaid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Agent -&gt; ModalFormula
</span><a href="ExampleDiningCryptographers.html#dontknowwhopaid"><span class="hs-identifier hs-var">dontknowwhopaid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Agent
</span><a href="ExampleDiningCryptographers.html#ag"><span class="hs-identifier hs-var">ag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | an example of Modal Formula to be verified at the end of the DC algorithm</span><span>
</span><span id="line-89"></span><span class="annot"><a href="ExampleDiningCryptographers.html#alpha2"><span class="hs-identifier hs-type">alpha2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#ModalFormula"><span class="hs-identifier hs-type">ModalFormula</span></a></span><span>
</span><span id="line-90"></span><span id="alpha2"><span class="annot"><span class="annottext">alpha2 :: ModalFormula
</span><a href="ExampleDiningCryptographers.html#alpha2"><span class="hs-identifier hs-var hs-var">alpha2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Agent -&gt; ModalFormula -&gt; ModalFormula
</span><a href="Logics.html#K"><span class="hs-identifier hs-var">K</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Agent
</span><a href="ExampleDiningCryptographers.html#ag"><span class="hs-identifier hs-var">ag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModalFormula -&gt; ModalFormula -&gt; ModalFormula
forall t. Formula t -&gt; Formula t -&gt; Formula t
</span><a href="Logics.html#Equiv"><span class="hs-identifier hs-var">Equiv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BExpr -&gt; ModalFormula
forall t. BExpr -&gt; Formula t
</span><a href="Logics.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span><span> </span><span class="annot"><span class="annottext">BExpr
</span><a href="ExampleDiningCryptographers.html#x"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ModalFormula] -&gt; ModalFormula
forall t. [Formula t] -&gt; Formula t
</span><a href="Logics.html#Disj"><span class="hs-identifier hs-var">Disj</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BExpr -&gt; ModalFormula
forall t. BExpr -&gt; Formula t
</span><a href="Logics.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; BExpr
</span><a href="ExampleDiningCryptographers.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066802"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679066802"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066802"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="ExampleDiningCryptographers.html#n"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | an example of Modal Formula to be verified at the end of the DC algorithm</span><span>
</span><span id="line-93"></span><span class="annot"><a href="ExampleDiningCryptographers.html#alpha3"><span class="hs-identifier hs-type">alpha3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logics.html#ModalFormula"><span class="hs-identifier hs-type">ModalFormula</span></a></span><span>
</span><span id="line-94"></span><span id="alpha3"><span class="annot"><span class="annottext">alpha3 :: ModalFormula
</span><a href="ExampleDiningCryptographers.html#alpha3"><span class="hs-identifier hs-var hs-var">alpha3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Agent -&gt; ModalFormula -&gt; ModalFormula
</span><a href="Logics.html#K"><span class="hs-identifier hs-var">K</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Agent
</span><a href="ExampleDiningCryptographers.html#ag"><span class="hs-identifier hs-var">ag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BExpr -&gt; ModalFormula
forall t. BExpr -&gt; Formula t
</span><a href="Logics.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; BExpr
</span><a href="ExampleDiningCryptographers.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- | proving \([progDC] \alpha_1\)</span><span>
</span><span id="line-98"></span><span id="dcAlpha1"><span class="annot"><span class="annottext">dcAlpha1 :: IO ThmResult
</span><a href="ExampleDiningCryptographers.html#dcAlpha1"><span class="hs-identifier hs-var hs-var">dcAlpha1</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Predicate -&gt; IO ThmResult
forall a. Provable a =&gt; a -&gt; IO ThmResult
</span><span class="hs-identifier hs-var">prove</span></span><span> </span><span class="annot"><span class="annottext">(Predicate -&gt; IO ThmResult) -&gt; Predicate -&gt; IO ThmResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; FOLFormula -&gt; FOLFormula -&gt; Predicate
</span><a href="ToSBV.html#toSBV"><span class="hs-identifier hs-var">toSBV</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="ExampleDiningCryptographers.html#allVars"><span class="hs-identifier hs-var">allVars</span></a></span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleDiningCryptographers.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FOLFormula -&gt; ModalFormula -&gt; FOLFormula
forall a. FOLFormula -&gt; Formula a -&gt; FOLFormula
</span><a href="Translation.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleDiningCryptographers.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; ModalFormula -&gt; ModalFormula
</span><a href="Logics.html#Box"><span class="hs-identifier hs-var">Box</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="ExampleDiningCryptographers.html#progDC"><span class="hs-identifier hs-var">progDC</span></a></span><span> </span><span class="annot"><span class="annottext">ModalFormula
</span><a href="ExampleDiningCryptographers.html#alpha1"><span class="hs-identifier hs-var">alpha1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | proving \([progDC] \alpha_2\)</span><span>
</span><span id="line-101"></span><span id="dcAlpha2"><span class="annot"><span class="annottext">dcAlpha2 :: IO ThmResult
</span><a href="ExampleDiningCryptographers.html#dcAlpha2"><span class="hs-identifier hs-var hs-var">dcAlpha2</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Predicate -&gt; IO ThmResult
forall a. Provable a =&gt; a -&gt; IO ThmResult
</span><span class="hs-identifier hs-var">prove</span></span><span> </span><span class="annot"><span class="annottext">(Predicate -&gt; IO ThmResult) -&gt; Predicate -&gt; IO ThmResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; FOLFormula -&gt; FOLFormula -&gt; Predicate
</span><a href="ToSBV.html#toSBV"><span class="hs-identifier hs-var">toSBV</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="ExampleDiningCryptographers.html#allVars"><span class="hs-identifier hs-var">allVars</span></a></span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleDiningCryptographers.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FOLFormula -&gt; ModalFormula -&gt; FOLFormula
forall a. FOLFormula -&gt; Formula a -&gt; FOLFormula
</span><a href="Translation.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleDiningCryptographers.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; ModalFormula -&gt; ModalFormula
</span><a href="Logics.html#Box"><span class="hs-identifier hs-var">Box</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="ExampleDiningCryptographers.html#progDC"><span class="hs-identifier hs-var">progDC</span></a></span><span> </span><span class="annot"><span class="annottext">ModalFormula
</span><a href="ExampleDiningCryptographers.html#alpha2"><span class="hs-identifier hs-var">alpha2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- -- ^</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- DC with \(\alpha_2\) as in IJCAI paper</span><span>
</span><span id="line-104"></span><span class="hs-comment">--</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- &gt;&gt;&gt; prove dcAlpha2</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | proving \([progDC] \alpha_3\) (should be falsified) </span><span>
</span><span id="line-109"></span><span id="dcAlpha3"><span class="annot"><span class="annottext">dcAlpha3 :: IO ThmResult
</span><a href="ExampleDiningCryptographers.html#dcAlpha3"><span class="hs-identifier hs-var hs-var">dcAlpha3</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Predicate -&gt; IO ThmResult
forall a. Provable a =&gt; a -&gt; IO ThmResult
</span><span class="hs-identifier hs-var">prove</span></span><span> </span><span class="annot"><span class="annottext">(Predicate -&gt; IO ThmResult) -&gt; Predicate -&gt; IO ThmResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; FOLFormula -&gt; FOLFormula -&gt; Predicate
</span><a href="ToSBV.html#toSBV"><span class="hs-identifier hs-var">toSBV</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="ExampleDiningCryptographers.html#allVars"><span class="hs-identifier hs-var">allVars</span></a></span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleDiningCryptographers.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FOLFormula -&gt; ModalFormula -&gt; FOLFormula
forall a. FOLFormula -&gt; Formula a -&gt; FOLFormula
</span><a href="Translation.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">FOLFormula
</span><a href="ExampleDiningCryptographers.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; ModalFormula -&gt; ModalFormula
</span><a href="Logics.html#Box"><span class="hs-identifier hs-var">Box</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="ExampleDiningCryptographers.html#progDC"><span class="hs-identifier hs-var">progDC</span></a></span><span> </span><span class="annot"><span class="annottext">ModalFormula
</span><a href="ExampleDiningCryptographers.html#alpha3"><span class="hs-identifier hs-var">alpha3</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- ^</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- DC with \(\alpha_3\) as in IJCAI paper</span><span>
</span><span id="line-112"></span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- &gt;&gt;&gt; prove dcAlpha3</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- Falsifiable. Counter-example:</span><span>
</span><span id="line-115"></span><span class="hs-comment">--   x  = False :: Bool</span><span>
</span><span id="line-116"></span><span class="hs-comment">--   c0 = False :: Bool</span><span>
</span><span id="line-117"></span><span class="hs-comment">--   c1 = False :: Bool</span><span>
</span><span id="line-118"></span><span class="hs-comment">--   p0 = False :: Bool</span><span>
</span><span id="line-119"></span><span class="hs-comment">--   p1 = False :: Bool</span><span>
</span><span id="line-120"></span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span></pre></body></html>